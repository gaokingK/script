# vim 
- vimtutor zh 打开中文的tutorials
- 在vim 窗口中F1
- vim操作命令大全: https://blog.csdn.net/weixin_37657720/article/details/80645991
- https://www.fprintf.net/vimCheatSheet.html
## 命令

## 问题和注意
- 如何将复制的内容复制到vim的命令输入中
  - 选中变量；进入命令行；先按ctrl+r 再按ctrl+w 命令行中粘贴
  - 或者v选中；y复制；进入命令行；然后按 CTRL-W 这时候命令行会变成 /”；别着急 再按一个0 就变成了 yank的那个字符串了~~~
- ` shitf +* 或gd `能选中变量
- ctrl+r, ctrl+w是什么操作
- w和W的区别是边界符的不同，w的边界符包括white space, tabs, <EOL>，标点符号，{},[],()等；W 的边界符只是white space,tab和<EOL>；b和B的区别同w/W
- 按了Ctrl+S后怎么都不动了。只能关闭SSH窗口。
  - Ctrl+Q ：解锁屏幕
  - Ctrl+ S ：锁定屏幕

##### 插入
- 按8，再按i，进入插入模式，输入=， 按esc进入命令模式，就会出现8个=。 这在插入分割线时非常有用，如30i+<esc>就插入了36个+组成的分割线。
- :r !command可以将其它shell命令的输出插入当前文档的光标处。

##### 移动光标
- link:https://blog.csdn.net/weixin_37657720/article/details/80645991
- nG 或者:n 移动到第n行 或者输入:linenum
- ctrl + f/d 下翻一屏/半屏
- ctrl + b/u 上翻一屏/半屏

- ^ 移动到当前行非空字符处

- b/w 向前移动向后移动到单词开头/结尾
- B/W 向前移动向后移动到单词开头/结尾, 忽略单词中间的标点如'aaaa-bbbg'看为一个单词



##### 替换: 
- https://zhuanlan.zhihu.com/p/532258691
- 语法`:[range]s/源字符串/目的字符串/[option]` s是substitute的缩写
  - [range]表示检索范围:
    - [range]省略时表示当前行
    - "1,n": 表示从第1行到n行
    - "%": 表示整个文件,同"1,$"
    - ".,$": 表示从当前行到文件尾
  
  - s:表示替换操作,其为substitute的缩写
    - [option] : 表示操作类型
      - [option]省略时仅对每行第一个匹配串进行替换
      - g/c
      - p 表示替代结果逐行显示(Ctrl + L恢复屏幕) ---------no
      - i:ignore,不区分大小写
      - 如果在源字符串和目的字符串中出现特殊字符,如'/','<','>',','等需要前面加反斜杠\进行转义
- 问题
  - 怎么设置替换次数

#### 搜索
- [关于在vim中的查找和替换](https://www.cnblogs.com/huxinga/p/7942194.html)
- / and ? 前者是从上往下搜索，后者是从下往上搜索.
- n and N 前者是下一个结果，后者是上一个结果
- #向上找到文件头，在找到自己； *向下找到文件尾，再找到当前位置
- 取消搜索高亮 :noh
- 在查找模式中加入\c表示大小写不敏感查找，\C表示大小写敏感查找。例如：`/foo\c`
- 取消高亮 `:nohlsearch`  也可以`:set nohlsearch`； 当然，可以简写，`:noh`或者`set noh`。
### 刷新文件
- `:e`
### 撤销
  - u（撤销操作），U（撤销某一行最近所有修改），Ctrl+R（重做）
  - Vim 的撤销和恢复功能是基于编辑操作的堆栈结构。每次编辑操作都会被添加到堆栈中，撤销操作会将最近的编辑操作从堆栈中弹出，并将其恢复到之前的状态。因此，如果你执行了其他编辑操作（例如插入、删除、替换等），撤销操作将会受到影响。确保在撤销和恢复之间没有执行其他编辑操作，以便正确恢复到预期的状态。

### 剪切、复制、粘贴、寄存器
- link
  - https://blog.csdn.net/weixin_42859280/article/details/86483273
- 复制 y(yank提起)
  - y 在使用v模式选定了某一块的时候，复制选定块到缓冲区用；
  - y^ 复制当前到行头的内容；
  - y$ 复制当前到行尾的内容；
  - yy 复制整行（nyy或者yny ，复制n行，n为数字）；
  - yw 复制一个word （nyw或者ynw，复制n个word，n为数字）；
  - yG 复制至档尾（nyG或者ynG，复制到第n行，例如1yG或者y1G，复制到档尾）
  
- 剪切 d(delete)
  - link:https://zhuanlan.zhihu.com/p/159458128
  - 和y类似
  - y or D: 删除（剪切）当前位置到行尾的内容 
  - d1w 删除从光标到单词的结尾
  - diw 删除光标所在的单词
  - d 方向下键删除本行和下一行
  - d2方向下键/2d方向下键 删除本行和下两行
  - d^ 删除到航头的（不包括空格）

- 粘贴 p (put放下)
  - p小写p代表贴至游标后（下，一整行的话），因为游标是在具体字符的位置上，所以实际是在该字符的后面
  - 大写P代表贴至游标前（上）
  - Np代表粘贴N次
- 寄存器
  - vim有12个粘贴板，分别是0、1、2、...、9、a、“、＋；用:reg命令可以查看各个粘贴板里的内容。在vim中简单用y只是复制到“（双引号)粘贴板里，同样用p粘贴的也是这个粘贴板里的内容；
  - 要将vim的内容复制到某个粘贴板，需要退出编辑模式，进入正常模式后，选择要复制的内容，然后按"Ny完成复制，其中N为粘贴板号(注意是按一下双引号然后按粘贴板号最后按y)，例如要把内容复制到粘贴板a，选中内容后按"ay就可以了，有两点需要说明一下：
    - “号粘贴板（临时粘贴板）比较特殊，直接按y就复制到这个粘贴板中了，直接按p就粘贴这个粘贴板中的内容；
    - +号粘贴板是系统粘贴板，用"+y将内容复制到该粘贴板后可以使用Ctrl＋V将其粘贴到其他文档（如firefox、gedit）中，同理，要把在其他地方用Ctrl＋C或右键复制的内容复制到vim中，需要在正常模式下按"+p；

  - 要将vim某个粘贴板里的内容粘贴进来，需要退出编辑模式，在正常模式按`"Np`，其中N为粘贴板号(不要忘记冒号`"`)，如上所述，可以按`"5p`将5号粘贴板里的内容粘贴进来，也可以按`"+p`将系统全局粘贴板里的内容粘贴进来。
  - 只有vim.gtk或vim.gnome才能使用系统全局粘贴板，默认的vim.basic看不到+号寄存器 这时可以在normal模式下直接粘贴

### 块编辑
- Visual Line模式（就像光标选中那样）
  - 按v进入
  - ^ ：选中当前行，光标位置到行首（或者使用键盘的HOME键）
  - $ ——–选中当前行，光标位置到行尾（或者使用键盘的END键）
- visual Block模式（多行）
  - [Vim下多行同时编辑与删除技巧](https://www.jianshu.com/p/50d5b6cfd73b)
  - 编辑和删除替换是不一样的操作
  - 编辑是ctrl-v进入块编辑;选中; I进入编辑; 输入内容; esc退出;
  - 删除是ctrl-v进入块编辑; 使用motion选中一个块(j向下, l向右;或者使用方向键);按下d,就删除了所有选中的内容;
  - 替换是选中行; :s/aa/bb/g将aa替换成bb 

#### 多标签编辑
- :tabe, tabnew – 如果加文件名，就在新的标签中打开这个文件， 否则打开一个空缓冲区。
  - 使用tab键给出提示, enter选中并打开, 可以使用向下方向键把光标处的给放到下面, 向上返回, 左右移动
- :tabn – 切换到下一个标签。Control + PageDown，也可以。
- [n] gt – 切换到下一个标签。如果前面加了 n ， 就切换到第n个标签。第一个标签的序号就是1。

### 打开文件目录树然后挑选一个文件来打开
- 如果你正在编辑一个文件，然后又想同时打开另外一个文件，但是又不知道文件路径，所以不能用tabe来看，就可以用这个
- :Explore #当前窗口下打开 缩写为`:E`
- :Vexplore #竖直分割窗口打开 缩写为`:Ve`
- :Sexplore #水平分割窗口打开 缩写为`:se`
- 
- i 切换文件视图

#### 执行系统命令
- [VIM中执行Shell命令](https://blog.csdn.net/bnxf00000/article/details/46618465/)
- :!command
  - 某些命令返回-1
  - grep `pattern ()`返回-1 因为() 应该转义 使用`grep "pattern\(\)"`


  
#### 查看vim输入过的历史命令
- q: 在normal模式下输入 按enter使用
- q/ 查看使用/输入的搜索历史
- q? 查看使用？输入的搜索历史
- q 后面如果跟随其它字母，是进入命令记录。 -------------------no

- 可以像编辑缓冲区一样(i)编辑某个命令，然后回车执行。
- ctrl-c 能粘贴命令退出历史编辑，但此时历史编辑窗口不关闭，可以参照之前的命令再自己输入。会把光标所在的给贴到编辑命令的地方
- :x 关闭历史编辑并放弃编辑结果，也可以在空命令上回车相当于退出。
  

### other
- :bd关闭 多个标签中一个
- vim filename +n 打开时到n行
- vim 里打开别的文件 参见 多标签编辑
- vim 配置------------------------------no
- y2w 表示复制两个词，包括它们之间的空格
- shell 中进入函数 在函数名上按# 会在函数定义和函数引用处 （其实就是#搜索，按*就是使用\*搜索）
- ctrl shift v 在vim中粘贴
```shell
#使用#作为分隔符,此时中间出现的/不会作为分隔符,如:将当前行的字符串"a/"替换为"b/"
:s#a/#b/#

:g/a/d #找到包含字母a的行并删除
:g/^$/d #删除所有空行

:s/ \+/ /g #多个空格替换为一个空格

#在正则表达式中使用和符号括起正则表达式,即可在后面使用\1,\2等变量来访问和中的内容,如下
:s/\w\+\s\+\w\+/\2\t\1 # 将data1 data2修改为data2 data1
```

### 问题
- E212: Can't open file for writing
    - 保存文件时出现这个，退出时出现138，解决玩138后这个错误也消失了
- E138: Can't write viminfo file /Users/henrik/.viminfo!
https://unix.stackexchange.com/questions/134500/vim-error-e138-cant-write-viminfo-file-home-viminfo
解决办法是： rm -rf ~/.viminf*  # Remove them.
